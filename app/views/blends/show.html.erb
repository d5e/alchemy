<div class="panel panel-primary <%= resource_class_name %> <%= bg_color_class(resource.color) %>" style="border-color:#<%= resource.color %>;">
    <div class="panel-heading" style="background-color:#<%= resource.color %>; border-color:#<%= resource.color %>;">
        <h3 class="panel-title">
            <div style="float:right;">
                <%= link_to dilute_blend_path(resource), style: "margin-right: 9px;" do %>
                    <span class="glyphicon glyphicon-wrench"></span>
                <% end %>
                <%= link_to edit_resource_path(resource), style: 'float: right;', title: "Edit", :'data-toggle' => "tooltip" do %>
                    <span class="glyphicon glyphicon-edit"></span>
                <% end %>
            </div>
            <%= resource.name %>, <span style="font-size: 11px;"><%= resource.creation_at %></span>
        </h3>
    </div>
    <div class="panel-body">
       <div class="row">
            <%= content_tag :span, resource_class.human_attribute_name(:sensory_tags), class: 'col-sm-2 small-label' %>
            <div class="col-sm-9">
                <%= resource.sensory_tags %>
            </div>
        </div>
        <hr/>

        <div class="row">
             <%= content_tag :span, resource_class.human_attribute_name(:character), class: 'col-sm-2 small-label' %>
             <div class="col-sm-9">
                 <%= render 'character_strip', blend: resource %>
             </div>
         </div>
         <hr/>

        <div class="row">
            <%= content_tag :span, resource_class.human_attribute_name(:notes), class: 'col-sm-2 small-label' %>
            <div class="col-sm-9">
                <%= simple_format resource.notes %>
            </div>
        </div>
        <hr/>
        <div class="row">
            <%= content_tag :span, Ingredient.model_name.human(count: 2), class: 'col-sm-2 small-label' %>
            <div class="col-sm-9">
                <%= nav_tabs :composition_as do |tabs| %>
                    <% tabs.add "Normalized composition", 'ingredients_table' %>
                    <% tabs.add "Ingredients", 'substances_table' %>
                <% end %>
            </div>
        </div>

        <% if resource.children.present? %>
            <div class="row">
                <%= content_tag :span, "children", class: 'col-sm-2 small-label' %>
                <div class="col-sm-9">
                    <div class="buttons-container">
                        
                    </div>
                    <% resource.children.each do |child| %>
                        <%= link_to child, child, colored(child, class: "btn btn-default btn-sm") %>
                    <% end %>
                </div>
            </div>
        <% end %>

        
     </div>
    <div class="panel-footer">
        <button class="btn btn-default" data-toggle="modal" data-target="#bottle-wizard">
            <span class="glyphicon glyphicon-new-window"></span> Bottle
        </button>
        <%= link_to separating_path(resource.id), class: "btn btn-default" do %>
            <span class="glyphicon glyphicon-new-window"></span> <%= t :'global.separate' %>
        <% end %>
        <p style="float:right; line-height: 34px;">
            <button class="btn btn-default" data-toggle="modal" data-target="#adjust-wizard">
                <span class="glyphicon glyphicon-wrench"></span> Adjust
            </button>
            <%= number_with_precision resource.concentration * 100, precision: 1 %> %
            <%= concentration_human resource %>
        </p>
    </div>
</div>
<p>
    <%= link_to blends_path, :class => "btn btn-default" do %>
        <span class="glyphicon glyphicon-th-list"></span> Index
    <% end %>
</p>



<div class="modal fade" id="adjust-wizard" tabindex="-1" role="dialog" aria-labelledby="Adjust Wizard" aria-hidden="true">
    <div class="modal-dialog">
        <%= form_tag adjust_blend_path(resource) do %>
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="myModalLabel">Adjust Wizard</h4>
                </div>
                <div class="modal-body">
                    <p>
                        Please enter the desired concentration.
                    </p>
                    <div class="form-inline">
                        <div class="form-group">
                            <div class="input-group">
                                <%= text_field_tag :concentration, nil, class: 'form-control', placeholder: "max: #{number_with_precision resource.max_concentration * 100} %", autocomplete: "off" %>
                                <div class="input-group-addon">%</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Adjust <span class="glyphicon glyphicon-wrench"></span></button>
                </div>
            </div>
        <% end %>
    </div>
</div>






<div class="modal fade" id="bottle-wizard" tabindex="-1" role="dialog" aria-labelledby="Bottling Wizard" aria-hidden="true">
    <div class="modal-dialog">
        <%= form_tag bottle_blend_path(resource), :remote => true do %>
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="myModalLabel">Bottling Wizard</h4>
                </div>
                <div class="modal-body">
                    <p>
                        You are about to bottle this blend into a new container and give it a new name. You can
                        choose the desired total amount (weight) of the final product and alchemy will create a new blend 
                        with this recipe and calculate the ingredients and amounts needed.
                    </p>
                    <hr/>
                    <div class="form-group">
                        <%= text_field_tag :new_blend_name, "#{resource.name}, bottled", class: 'form-control', placeholder: "Name of new blend" %>
                    </div>
                    <div class="form-inline">
                        <div class="form-group">
                            <div class="input-group">
                                <%= text_field_tag :amount_in_gram, nil, class: 'form-control', placeholder: "weight" %>
                                <div class="input-group-addon">gram</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Bottle <span class="glyphicon glyphicon-new-window"></span></button>
                </div>
            </div>
        <% end %>
    </div>
</div>
